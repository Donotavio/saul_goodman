const translations = {
  pt: {
    navProcess: 'Processo',
    navDemo: 'Demonstração',
    navClients: 'Clientes',
    navBlog: 'Blog',
    navCta: 'Instalar',
    seoTitle: 'Saul Goodman - Extensão Anti-Procrastinação',
    seoDescription:
      'Saul Goodman fiscaliza suas abas, combate a procrastinação e gera relatórios dramáticos direto no navegador. Tudo local, sem servidores externos.',
    languageLabel: 'Selecionar idioma',
    heroTag: '100% SIGILO PROFISSIONAL',
    heroTitle: 'Seu advogado particular contra a procrastinação.',
    heroSubtitle:
      'Saul Goodman fiscaliza suas abas, julga o seu foco e entrega relatórios dramáticos — tudo no seu navegador, sem enviar um byte para fora.',
    heroPrimaryCta: 'Instalar extensão',
    heroSecondaryCta: 'Conheça o plano de defesa',
    heroConfidence1: 'Modo terremoto personalizado',
    heroConfidence2: 'Lista negra & lista VIP de domínios',
    heroConfidence3: 'Relatório com storytelling IA',
    heroBadge: '“Em caso de preguiça... CALL SAUL!”',
    reasonsEyebrow: 'Por que instalar',
    reasonsTitle: 'Saul transforma procrastinação em depoimento favorável. Veja como.',
    reason1Title: 'Manda o vilão direto ao tribunal',
    reason1Body:
      'Listas personalizadas separam domínios produtivos de tentações. Saul apita sempre que alguém tenta corromper seu foco.',
    reason2Title: 'Alertas à la comercial de TV dos anos 90',
    reason2Body: 'Tremor na tela e sirene garantem que a procrastinação sinta o peso da lei antes de virar reincidente.',
    reason3Title: 'Relatório dramático para apresentar ao chefe',
    reason3Body: 'Gráficos, timeline e storytelling IA prontos para anexar na pauta da daily ou na conversa de feedback.',
    reason4Title: 'Sigilo profissional',
    reason4Body: 'Zero servidores externos. Tudo é calculado no seu navegador — nem o juiz tem acesso.',
    processEyebrow: 'Fluxo jurídico',
    processTitle: 'Como Saul monta o seu caso diariamente.',
    process1Title: 'Investigação contínua',
    process1Body:
      'Um content script discreto registra cliques, teclas e domínio ativo para que ninguém marque você como ausente antes da hora.',
    process2Title: 'Julgamento imparcial',
    process2Body:
      'O Service Worker cruza domínios produtivos e vilões, calcula o índice de procrastinação e atualiza o badge em tempo real.',
    process3Title: 'Defesa dramática',
    process3Body:
      'Os relatórios diários geram gráficos, timeline minuto a minuto e até narrativa IA em tom Saul Goodman para apresentar ao “juiz” (você mesmo).',
    featuresEyebrow: 'Features detalhadas',
    featuresTitle: 'O arsenal da extensão Saul Goodman.',
    feature1Title: 'Dashboard em tempo real',
    feature1Item1: 'Badge com índice atual e mensagens sarcásticas.',
    feature1Item2: 'Top domínios produtivos e vilões com tempo formatado.',
    feature1Item3: 'Exportações CSV/PDF com um clique.',
    feature2Title: 'Modo terremoto',
    feature2Item1: 'Limiar configurável e sirene opcional.',
    feature2Item2: 'Overlay crítico com contador regressivo e CTA.',
    feature2Item3: 'Bloqueia somente as abas vilãs para você recuperar em produtivas.',
    feature3Title: 'Relatório dramático',
    feature3Item1: 'Gráficos por hora e breakdown de trocas de aba.',
    feature3Item2: 'Narrativa IA em tom Better Call Saul.',
    feature3Item3: 'Banner crítico com plano de ação imediato.',
    feature4Title: 'Privacidade total',
    feature4Item1: 'Dados em <code>chrome.storage.local</code> — nada é enviado à nuvem.',
    feature4Item2: 'Listas produtivas/vilãs salvas só no seu navegador.',
    feature4Item3: 'Chave OpenAI opcional e guardada localmente.',
    integrationEyebrow: 'Para devs',
    integrationTitle: 'VS Code + daemon local, tudo como foco produtivo.',
    integrationLead: 'Ative a integração opcional: Saul soma sessões do editor como tempo produtivo sem sair do localhost.',
    integrationCard1Title: 'Ligue nas opções',
    integrationCard1Body: 'Gere a chave de pareamento, ative a integração e configure a URL local. Nada sai do seu navegador.',
    integrationCard2Title: 'Daemon local',
    integrationCard2Body:
      'Use o comando da extensão VS Code para iniciar: ele já preenche PAIRING_KEY/PORT e abre no diretório do daemon.',
    integrationCard3Title: 'Extensão VS Code',
    integrationCard3Body:
      'Comando “Saul Goodman: preparar comando do SaulDaemon” vem pronto após instalar e envia batimentos do editor para o Chrome.',
    integrationVsixCta: 'Instalar extensão VS Code',
    integrationCta: 'Ver guia da integração',
    manifestoEyebrow: 'Manifesto',
    manifestoTitle: 'Marketing agressivo com uma pitada de ética.',
    manifesto1Title: '100% local',
    manifesto1Body: 'Seu dia é julgado dentro do navegador. Nenhum dado sai do computador, nem com ordem do juiz.',
    manifesto2Title: 'Transparência na cobrança',
    manifesto2Body: 'Alertas visuais e sonoros deixam claro quando Saul está prestes a cobrar honorários extras.',
    manifesto3Title: 'Humor como arma',
    manifesto3Body: 'Mensagens sarcásticas e banners dramáticos lembram que procrastinar também custa caro.',
    blogPreviewEyebrow: 'Blog do Saul',
    blogPreviewTitle: 'Últimos casos do tribunal digital.',
    blogPreviewLead:
      'Leia os 3 artigos mais recentes e descubra como o Saul defende o seu foco com sarcasmo jurídico.',
    blogPreviewLoading: 'Carregando artigos...',
    blogPreviewEmpty: 'Nenhum artigo disponível no momento.',
    blogPreviewError: 'Não foi possível carregar os artigos.',
    blogPreviewCta: 'Ver todos os artigos',
    blogPreviewRead: 'Ler artigo',
    blogPreviewImageAlt: 'Ilustração Saul Goodman',
    splitPopupTitle: 'Popup de plantão',
    splitPopupBody:
      'O painel mostra o índice, top domínios, indicadores extras e permite exportar CSV/PDF. Quando o foco despenca, o modo terremoto invade para salvar a barra da justiça.',
    splitPopupCaption: 'Popup com índice, top domínios e exportações.',
    splitPopupCaption2: 'KPIs, top domínios e exportação rápida.',
    splitPopupCaption3: 'Listas produtivas/vilãs no painel de opções.',
    splitPopupCaption4: 'Pesos e horários configuráveis para cálculo do índice.',
    splitReportTitle: 'Relatório dramático',
    splitReportBody:
      'Gráficos por hora, ranking de vilões, narrativa IA e banner crítico com plano de ação. Tudo com visual juramentado.',
    splitReportCaption: 'Resumo do relatório com gráficos e ranking.',
    splitReportCaption2: 'Narrativa IA e timeline minuto a minuto.',
    splitReportCaption3: 'Ranking de vilões, campeões e distribuição.',
    splitStats1: 'Minutos recuperados/dia',
    splitStats2: 'Clientes absolvidos',
    demoViewFull: 'Ver em alta',
    reactionsEyebrow: 'Saul reage',
    reactionsTitle: 'O veredito instantâneo do Saul.',
    reactionsBody:
      'Quando o índice sobe, Saul fica incrédulo. Quando você volta ao foco, ele celebra. Pequenos lembretes visuais para manter a barra da justiça no lugar.',
    reactionDisbeliefLabel: 'Modo incrédulo',
    reactionDisbeliefText: '“Você chamou isso de foco?”',
    reactionDisbeliefHint: 'Aciona quando o índice passa do limiar de terremoto.',
    reactionBlockLabel: 'Modo bloqueio',
    reactionBlockText: '“Nem tente: vilões barrados no ato.”',
    reactionBlockAlt: 'Saul bloqueando o acesso',
    reactionBlockHint: 'Redireciona para a página de bloqueio com o Saul de cara fechada.',
    reactionHypeLabel: 'Modo aprovado',
    reactionHypeText: '“Assim eu até desconto honorários.”',
    reactionHypeHint: 'Aparece quando você volta às abas produtivas.',
    quakeDemoEyebrow: 'Modo terremoto (demo)',
    quakeDemoTitle: 'Teste o alerta mais dramático do Saul.',
    quakeDemoBody:
      'Clique para simular o modo terremoto: tremor de tela, sirene e mensagem dramática. Igual à extensão, mas só por alguns segundos aqui no site.',
    quakeDemoButton: 'Simular modo terremoto',
    quakeOverlayTitle: 'Modo terremoto acionado!',
    quakeOverlayBody: 'Saul está derrubando as abas vilãs. Volte ao foco antes que ele cobre honorários.',
    quakeOverlayClose: 'Voltar ao foco',
    timelineEyebrow: 'Linha do tempo',
    timelineTitle: 'Do rastreamento ao veredito.',
    timeline1Title: 'Radar inicial',
    timeline1Body: 'Content script detecta atividade nas primeiras abas. Saul registra quem é produtivo ou vilão.',
    timeline2Title: 'Auto de infração',
    timeline2Body:
      'Se o índice sobe demais, o modo terremoto invade o Chrome com tremor, sirene e CTA para virar o jogo.',
    timeline3Title: 'Sentença diária',
    timeline3Body:
      'Relatório detalhado envia gráficos, timeline e narrativa IA para encerrar o expediente com provas.',
    benefitsEyebrow: 'Benefícios',
    benefitsTitle: 'Saul cuida do processo, você fecha o caso.',
    benefit1Title: 'Provas incontestáveis',
    benefit1Body: 'Gráficos e CSV para apresentar ao chefe, à equipe ou ao seu próprio senso de culpa.',
    benefit2Title: 'Alertas cinematográficos',
    benefit2Body: 'Modo terremoto e mensagens sarcásticas que você nunca ignora.',
    benefit3Title: 'Privacidade garantida',
    benefit3Body: 'Todo o julgamento acontece localmente; nenhum dado deixa o seu navegador.',
    testimonialsEyebrow: 'Testemunhos',
    testimonialsTitle: 'Clientes absolvidos.',
    testimonial1Quote: '“Saul me lembrou que trocar 40 abas por hora é crime.”',
    testimonial1Cite: '— Cliente anônimo',
    testimonial2Quote: '“O relatório virou peça de defesa na reunião com o chefe.”',
    testimonial2Cite: '— Engenheiro arrependido',
    testimonial3Quote: '“O modo terremoto salvou meu sprint. Honorários pagos com gosto.”',
    testimonial3Cite: '— Product Manager',
    supportEyebrow: 'Projeto open-source',
    supportTitle: 'Acompanhe o código e apoie o Saul.',
    supportBody:
      'O repositório está aberto para você auditar, contribuir e sugerir melhorias. Se curtir o projeto, considere patrocinar para manter os alertas sempre prontos.',
    supportRepo: 'Ver repositório no GitHub',
    lightboxClose: 'Fechar',
    finalCtaTitle: 'Pronto para defender o seu foco?',
    finalCtaBody:
      'Instale a extensão, liste seus vilões e deixe Saul negociar com a sua procrastinação antes que ela vire caso de tribunal.',
    finalPrimary: 'Instalar agora',
    finalSecondary: 'Ver demonstração',
    faq1Question: 'É grátis?',
    faq1Answer: 'Totalmente. Saul só cobra atenção e senso de humor.',
    faq2Question: 'Meus dados saem do navegador?',
    faq2Answer: 'Jamais. Tudo fica em <code>chrome.storage.local</code>.',
    faq3Question: 'Preciso de IA?',
    faq3Answer: 'Só se quiser as narrativas no relatório. O resto funciona offline.',
    footerTitle: 'Saul Goodman Extension',
    footerBody: 'Instale, liste seus vilões e deixe Saul cobrar os honorários do foco.',
    footerLinkArchitecture: 'Arquitetura',
    footerLinkIndicators: 'Indicadores',
    footerLinkGithub: 'GitHub',
    footerPrivacy: 'Dados 100% locais. Nem o juiz vê.'
  },
  en: {
    navProcess: 'Process',
    navDemo: 'Demo',
    navClients: 'Clients',
    navBlog: 'Blog',
    navCta: 'Install',
    seoTitle: 'Saul Goodman - Anti-Procrastination Extension',
    seoDescription:
      'Saul Goodman polices your tabs, fights procrastination, and delivers dramatic reports in your browser. Everything stays local, no external servers.',
    languageLabel: 'Select language',
    heroTag: '100% ATTORNEY-CLIENT PRIVILEGE',
    heroTitle: 'Your personal lawyer against procrastination.',
    heroSubtitle:
      'Saul Goodman polices your tabs, judges your focus, and delivers dramatic reports — all in your browser with zero data leaving.',
    heroPrimaryCta: 'Install extension',
    heroSecondaryCta: 'See the defense plan',
    heroConfidence1: 'Custom earthquake mode',
    heroConfidence2: 'Blacklist & VIP domain lists',
    heroConfidence3: 'Report with AI storytelling',
    heroBadge: '“When laziness strikes... CALL SAUL!”',
    reasonsEyebrow: 'Why install',
    reasonsTitle: "Saul turns procrastination into favorable testimony. Here's how.",
    reason1Title: 'Send the villain straight to court',
    reason1Body:
      'Custom lists separate productive domains from temptations. Saul blows the whistle whenever someone tries to bribe your focus.',
    reason2Title: 'Alerts like a 90s TV commercial',
    reason2Body: 'Screen shake and siren make procrastination feel the law before it reoffends.',
    reason3Title: 'Dramatic report to show your boss',
    reason3Body: 'Charts, timeline, and AI storytelling ready to drop into the daily agenda or feedback chat.',
    reason4Title: 'Professional secrecy',
    reason4Body: "Zero external servers. Everything is calculated in your browser — not even the judge can see.",
    processEyebrow: 'Legal flow',
    processTitle: 'How Saul builds your case every day.',
    process1Title: 'Continuous investigation',
    process1Body:
      "A discreet content script logs clicks, keystrokes, and the active domain so nobody marks you as away before it's time.",
    process2Title: 'Impartial judgment',
    process2Body:
      'The Service Worker cross-checks productive and villain domains, calculates the procrastination index, and updates the badge in real time.',
    process3Title: 'Dramatic defense',
    process3Body:
      'Daily reports generate charts, minute-by-minute timeline, and even AI narrative in Saul Goodman tone to present to the “judge” (you).',
    featuresEyebrow: 'Detailed features',
    featuresTitle: 'The arsenal of the Saul Goodman extension.',
    feature1Title: 'Real-time dashboard',
    feature1Item1: 'Badge with current index and sarcastic messages.',
    feature1Item2: 'Top productive and villain domains with formatted time.',
    feature1Item3: 'CSV/PDF exports with one click.',
    feature2Title: 'Earthquake mode',
    feature2Item1: 'Configurable threshold and optional siren.',
    feature2Item2: 'Critical overlay with countdown and CTA.',
    feature2Item3: 'Blocks only villain tabs so you can recover in productive ones.',
    feature3Title: 'Dramatic report',
    feature3Item1: 'Charts per hour and tab-switch breakdown.',
    feature3Item2: 'AI narrative in Better Call Saul tone.',
    feature3Item3: 'Critical banner with immediate action plan.',
    feature4Title: 'Total privacy',
    feature4Item1: 'Data in <code>chrome.storage.local</code> — nothing goes to the cloud.',
    feature4Item2: 'Productive/villain lists saved only in your browser.',
    feature4Item3: 'Optional OpenAI key stored locally.',
    integrationEyebrow: 'For devs',
    integrationTitle: 'VS Code + local daemon, all counted as productive.',
    integrationLead: 'Turn on the optional integration: Saul adds editor time as productive without leaving localhost.',
    integrationCard1Title: 'Enable in options',
    integrationCard1Body: 'Generate the pairing key, toggle the integration, and set the local URL. Nothing leaves your browser.',
    integrationCard2Title: 'Local daemon',
    integrationCard2Body:
      'Use the VS Code extension command to start it: it pre-fills PAIRING_KEY/PORT and opens in the daemon folder.',
    integrationCard3Title: 'VS Code extension',
    integrationCard3Body:
      'Command “Saul Goodman: preparar comando do SaulDaemon” ships ready after install and sends editor heartbeats to Chrome.',
    integrationVsixCta: 'Install VS Code extension',
    integrationCta: 'See integration guide',
    manifestoEyebrow: 'Manifesto',
    manifestoTitle: 'Aggressive marketing with a pinch of ethics.',
    manifesto1Title: '100% local',
    manifesto1Body: 'Your day is judged inside the browser. No data leaves the computer, not even by court order.',
    manifesto2Title: 'Transparent billing',
    manifesto2Body: 'Visual and sound alerts make it clear when Saul is about to charge extra fees.',
    manifesto3Title: 'Humor as weapon',
    manifesto3Body: 'Sarcastic messages and dramatic banners remind you procrastination is also expensive.',
    blogPreviewEyebrow: 'Saul Blog',
    blogPreviewTitle: 'Latest cases from the digital courtroom.',
    blogPreviewLead: 'Read the 3 newest articles and see how Saul defends your focus with legal sarcasm.',
    blogPreviewLoading: 'Loading articles...',
    blogPreviewEmpty: 'No articles available right now.',
    blogPreviewError: 'Unable to load articles.',
    blogPreviewCta: 'See all articles',
    blogPreviewRead: 'Read article',
    blogPreviewImageAlt: 'Saul Goodman illustration',
    splitPopupTitle: 'On-call popup',
    splitPopupBody:
      'The panel shows the index, top domains, extra indicators, and lets you export CSV/PDF. When focus drops, earthquake mode storms in to save the bar of justice.',
    splitPopupCaption: 'Popup with index, top domains, and exports.',
    splitPopupCaption2: 'KPIs, top domains, and quick export.',
    splitPopupCaption3: 'Productive/villain lists in the options panel.',
    splitPopupCaption4: 'Configurable weights and schedules for the index.',
    splitReportTitle: 'Dramatic report',
    splitReportBody:
      'Charts per hour, villain ranking, AI narrative, and critical banner with action plan. All with sworn visuals.',
    splitReportCaption: 'Report summary with charts and ranking.',
    splitReportCaption2: 'AI narrative and minute-by-minute timeline.',
    splitReportCaption3: 'Villain ranking, champions, and distribution.',
    splitStats1: 'Minutes recovered/day',
    splitStats2: 'Clients acquitted',
    demoViewFull: 'View full size',
    reactionsEyebrow: 'Saul reacts',
    reactionsTitle: 'Saul’s instant verdict.',
    reactionsBody:
      'When the index spikes, Saul is incredulous. When you return to focus, he celebrates. Quick visuals to keep the bar of justice in place.',
    reactionDisbeliefLabel: 'Incredulous mode',
    reactionDisbeliefText: '“You call that focus?”',
    reactionDisbeliefHint: 'Triggers when the quake threshold is crossed.',
    reactionBlockLabel: 'Block mode',
    reactionBlockText: '“Don’t even try it: villains get blocked instantly.”',
    reactionBlockAlt: 'Saul blocking the access',
    reactionBlockHint: 'Redirects to the block page with Saul shutting the door.',
    reactionHypeLabel: 'Approved mode',
    reactionHypeText: '“Now I might discount my fees.”',
    reactionHypeHint: 'Shows up when you jump back to productive tabs.',
    quakeDemoEyebrow: 'Earthquake mode (demo)',
    quakeDemoTitle: 'Test Saul’s most dramatic alert.',
    quakeDemoBody:
      'Click to simulate earthquake mode: screen shake, siren, and a dramatic message. Same as the extension, but only for a few seconds here.',
    quakeDemoButton: 'Simulate earthquake mode',
    quakeOverlayTitle: 'Earthquake mode triggered!',
    quakeOverlayBody: 'Saul is shaking villain tabs. Get back to focus before he charges extra.',
    quakeOverlayClose: 'Back to focus',
    timelineEyebrow: 'Timeline',
    timelineTitle: 'From tracking to verdict.',
    timeline1Title: 'Initial radar',
    timeline1Body: 'Content script detects activity on first tabs. Saul logs who is productive or a villain.',
    timeline2Title: 'Infraction notice',
    timeline2Body:
      'If the index climbs too high, earthquake mode storms Chrome with quake, siren, and CTA to turn the game.',
    timeline3Title: 'Daily sentence',
    timeline3Body:
      'Detailed report ships charts, timeline, and AI narrative to close the day with evidence.',
    benefitsEyebrow: 'Benefits',
    benefitsTitle: 'Saul handles the case, you close it.',
    benefit1Title: 'Undeniable evidence',
    benefit1Body: 'Charts and CSV to show your boss, team, or your own conscience.',
    benefit2Title: 'Cinematic alerts',
    benefit2Body: "Earthquake mode and sarcastic messages you can't ignore.",
    benefit3Title: 'Guaranteed privacy',
    benefit3Body: 'All judgment happens locally; no data leaves your browser.',
    testimonialsEyebrow: 'Testimonials',
    testimonialsTitle: 'Clients acquitted.',
    testimonial1Quote: '“Saul reminded me that switching 40 tabs per hour is a crime.”',
    testimonial1Cite: '— Anonymous client',
    testimonial2Quote: '“The report became a defense piece in the meeting with my boss.”',
    testimonial2Cite: '— Regretful engineer',
    testimonial3Quote: '“Earthquake mode saved my sprint. Fees gladly paid.”',
    testimonial3Cite: '— Product Manager',
    supportEyebrow: 'Open-source project',
    supportTitle: 'Track the code and support Saul.',
    supportBody:
      'The repository is open for you to audit, contribute, and suggest improvements. If you like it, consider sponsoring to keep the alerts sharp.',
    supportRepo: 'View repository on GitHub',
    lightboxClose: 'Close',
    finalCtaTitle: 'Ready to defend your focus?',
    finalCtaBody:
      'Install the extension, list your villains, and let Saul negotiate with your procrastination before it goes to court.',
    finalPrimary: 'Install now',
    finalSecondary: 'See demo',
    faq1Question: 'Is it free?',
    faq1Answer: 'Totally. Saul only charges attention and humor.',
    faq2Question: 'Do my data leave the browser?',
    faq2Answer: 'Never. Everything stays in <code>chrome.storage.local</code>.',
    faq3Question: 'Do I need AI?',
    faq3Answer: 'Only if you want narratives in the report. The rest works offline.',
    footerTitle: 'Saul Goodman Extension',
    footerBody: 'Install, list your villains, and let Saul collect focus fees.',
    footerLinkArchitecture: 'Architecture',
    footerLinkIndicators: 'Indicators',
    footerLinkGithub: 'GitHub',
    footerPrivacy: '100% local data. Not even the judge sees it.'
  },
  es: {
    navProcess: 'Proceso',
    navDemo: 'Demostración',
    navClients: 'Clientes',
    navBlog: 'Blog',
    navCta: 'Instalar',
    seoTitle: 'Saul Goodman - Extensión Anti-Procrastinación',
    seoDescription:
      'Saul Goodman vigila tus pestañas, combate la procrastinación y genera informes dramáticos en tu navegador. Todo queda local, sin servidores externos.',
    languageLabel: 'Seleccionar idioma',
    heroTag: '100% SECRETO PROFESIONAL',
    heroTitle: 'Tu abogado particular contra la procrastinación.',
    heroSubtitle:
      'Saul Goodman vigila tus pestañas, juzga tu foco y entrega informes dramáticos, todo en tu navegador sin enviar ni un byte afuera.',
    heroPrimaryCta: 'Instalar extensión',
    heroSecondaryCta: 'Conoce el plan de defensa',
    heroConfidence1: 'Modo terremoto personalizado',
    heroConfidence2: 'Lista negra y lista VIP de dominios',
    heroConfidence3: 'Informe con narrativa IA',
    heroBadge: '“En caso de pereza... CALL SAUL!”',
    reasonsEyebrow: 'Por qué instalar',
    reasonsTitle: 'Saul convierte la procrastinación en testimonio a favor. Mira cómo.',
    reason1Title: 'Envía al villano directo al tribunal',
    reason1Body:
      'Listas personalizadas separan dominios productivos de tentaciones. Saul pita siempre que alguien intenta sobornar tu foco.',
    reason2Title: 'Alertas estilo comercial de TV de los 90',
    reason2Body:
      'Sacudida en la pantalla y sirena garantizan que la procrastinación sienta el peso de la ley antes de reincidir.',
    reason3Title: 'Informe dramático para mostrar al jefe',
    reason3Body:
      'Gráficos, línea del tiempo y narrativa IA listos para anexar a la daily o a la charla de feedback.',
    reason4Title: 'Secreto profesional',
    reason4Body: 'Cero servidores externos. Todo se calcula en tu navegador; ni el juez lo ve.',
    processEyebrow: 'Flujo jurídico',
    processTitle: 'Cómo Saul arma tu caso a diario.',
    process1Title: 'Investigación continua',
    process1Body:
      'Un content script discreto registra clics, teclas y dominio activo para que nadie te marque como ausente antes de tiempo.',
    process2Title: 'Juicio imparcial',
    process2Body:
      'El Service Worker cruza dominios productivos y villanos, calcula el índice de procrastinación y actualiza el badge en tiempo real.',
    process3Title: 'Defensa dramática',
    process3Body:
      'Los informes diarios generan gráficos, línea del tiempo minuto a minuto y narrativa IA en tono Saul Goodman para presentar al “juez” (tú).',
    featuresEyebrow: 'Funciones detalladas',
    featuresTitle: 'El arsenal de la extensión Saul Goodman.',
    feature1Title: 'Dashboard en tiempo real',
    feature1Item1: 'Badge con índice actual y mensajes sarcásticos.',
    feature1Item2: 'Top dominios productivos y villanos con tiempo formateado.',
    feature1Item3: 'Exportaciones CSV/PDF con un clic.',
    feature2Title: 'Modo terremoto',
    feature2Item1: 'Umbral configurable y sirena opcional.',
    feature2Item2: 'Overlay crítico con contador regresivo y CTA.',
    feature2Item3: 'Bloquea solo las pestañas villanas para que recuperes en productivas.',
    feature3Title: 'Informe dramático',
    feature3Item1: 'Gráficos por hora y breakdown de cambios de pestaña.',
    feature3Item2: 'Narrativa IA en tono Better Call Saul.',
    feature3Item3: 'Banner crítico con plan de acción inmediato.',
    feature4Title: 'Privacidad total',
    feature4Item1: 'Datos en <code>chrome.storage.local</code>; nada va a la nube.',
    feature4Item2: 'Listas productivas/villanas guardadas solo en tu navegador.',
    feature4Item3: 'Clave OpenAI opcional y guardada localmente.',
    integrationEyebrow: 'Para devs',
    integrationTitle: 'VS Code + daemon local, todo como tiempo productivo.',
    integrationLead: 'Activa la integración opcional: Saul suma sesiones del editor como productivas sin salir de localhost.',
    integrationCard1Title: 'Activa en opciones',
    integrationCard1Body: 'Genera la clave de pareamiento, habilita la integración y define la URL local. Nada sale de tu navegador.',
    integrationCard2Title: 'Daemon local',
    integrationCard2Body:
      'Usa el comando de la extensión VS Code para iniciarlo: ya rellena PAIRING_KEY/PORT y abre en la carpeta del daemon.',
    integrationCard3Title: 'Extensión VS Code',
    integrationCard3Body:
      'El comando “Saul Goodman: preparar comando do SaulDaemon” llega listo tras instalar y envía latidos del editor al Chrome.',
    integrationVsixCta: 'Instalar extensión VS Code',
    integrationCta: 'Ver guía de integración',
    manifestoEyebrow: 'Manifiesto',
    manifestoTitle: 'Marketing agresivo con una pizca de ética.',
    manifesto1Title: '100% local',
    manifesto1Body:
      'Tu día se juzga dentro del navegador. Ningún dato sale de la computadora, ni con orden del juez.',
    manifesto2Title: 'Transparencia en el cobro',
    manifesto2Body: 'Alertas visuales y sonoras dejan claro cuando Saul está a punto de cobrar honorarios extra.',
    manifesto3Title: 'Humor como arma',
    manifesto3Body: 'Mensajes sarcásticos y banners dramáticos recuerdan que procrastinar también cuesta caro.',
    blogPreviewEyebrow: 'Blog de Saul',
    blogPreviewTitle: 'Últimos casos del tribunal digital.',
    blogPreviewLead:
      'Lee los 3 artículos más recientes y descubre cómo Saul defiende tu foco con sarcasmo legal.',
    blogPreviewLoading: 'Cargando artículos...',
    blogPreviewEmpty: 'No hay artículos disponibles por ahora.',
    blogPreviewError: 'No fue posible cargar los artículos.',
    blogPreviewCta: 'Ver todos los artículos',
    blogPreviewRead: 'Leer artículo',
    blogPreviewImageAlt: 'Ilustración de Saul Goodman',
    splitPopupTitle: 'Popup de guardia',
    splitPopupBody:
      'El panel muestra el índice, top dominios, indicadores extra y permite exportar CSV/PDF. Cuando el foco cae, el modo terremoto invade para salvar la barra de la justicia.',
    splitPopupCaption: 'Popup con índice, top dominios y exportaciones.',
    splitPopupCaption2: 'KPIs, top dominios y exportación rápida.',
    splitPopupCaption3: 'Listas productivas/villanas en el panel de opciones.',
    splitPopupCaption4: 'Pesos y horarios configurables para el índice.',
    splitReportTitle: 'Informe dramático',
    splitReportBody:
      'Gráficos por hora, ranking de villanos, narrativa IA y banner crítico con plan de acción. Todo con visual jurada.',
    splitReportCaption: 'Resumen del informe con gráficos y ranking.',
    splitReportCaption2: 'Narrativa IA y timeline minuto a minuto.',
    splitReportCaption3: 'Ranking de villanos, campeones y distribución.',
    splitStats1: 'Minutos recuperados/día',
    splitStats2: 'Clientes absueltos',
    demoViewFull: 'Ver en alta',
    reactionsEyebrow: 'Saul reacciona',
    reactionsTitle: 'El veredicto instantáneo de Saul.',
    reactionsBody:
      'Cuando el índice sube, Saul queda incrédulo. Cuando vuelves al foco, él celebra. Recordatorios visuales para mantener la barra de la justicia en su sitio.',
    reactionDisbeliefLabel: 'Modo incrédulo',
    reactionDisbeliefText: '“¿Eso llamas foco?”',
    reactionDisbeliefHint: 'Se activa al pasar el umbral de terremoto.',
    reactionBlockLabel: 'Modo bloqueo',
    reactionBlockText: '“Ni lo intentes: los villanos se bloquean al instante.”',
    reactionBlockAlt: 'Saul bloqueando el acceso',
    reactionBlockHint: 'Redirige a la página de bloqueo con Saul cerrando la puerta.',
    reactionHypeLabel: 'Modo aprobado',
    reactionHypeText: '“Así hasta descuento honorarios.”',
    reactionHypeHint: 'Aparece cuando regresas a las pestañas productivas.',
    quakeDemoEyebrow: 'Modo terremoto (demo)',
    quakeDemoTitle: 'Prueba la alerta más dramática de Saul.',
    quakeDemoBody:
      'Haz clic para simular el modo terremoto: temblor de pantalla, sirena y mensaje dramático. Igual que en la extensión, pero solo por unos segundos aquí.',
    quakeDemoButton: 'Simular modo terremoto',
    quakeOverlayTitle: '¡Modo terremoto activado!',
    quakeOverlayBody: 'Saul está sacudiendo las pestañas villanas. Vuelve al foco antes de que cobre honorarios.',
    quakeOverlayClose: 'Volver al foco',
    timelineEyebrow: 'Línea del tiempo',
    timelineTitle: 'Del rastreo al veredicto.',
    timeline1Title: 'Radar inicial',
    timeline1Body:
      'El content script detecta actividad en las primeras pestañas. Saul registra quién es productivo o villano.',
    timeline2Title: 'Auto de infracción',
    timeline2Body:
      'Si el índice sube demasiado, el modo terremoto invade Chrome con temblor, sirena y CTA para dar vuelta el juego.',
    timeline3Title: 'Sentencia diaria',
    timeline3Body:
      'El informe detallado envía gráficos, línea del tiempo y narrativa IA para cerrar el día con pruebas.',
    benefitsEyebrow: 'Beneficios',
    benefitsTitle: 'Saul cuida del proceso, tú cierras el caso.',
    benefit1Title: 'Pruebas incontestables',
    benefit1Body: 'Gráficos y CSV para presentar al jefe, al equipo o a tu propia conciencia.',
    benefit2Title: 'Alertas cinematográficas',
    benefit2Body: 'Modo terremoto y mensajes sarcásticos que no ignoras.',
    benefit3Title: 'Privacidad garantizada',
    benefit3Body: 'Todo el juicio ocurre localmente; ningún dato sale del navegador.',
    testimonialsEyebrow: 'Testimonios',
    testimonialsTitle: 'Clientes absueltos.',
    testimonial1Quote: '“Saul me recordó que cambiar 40 pestañas por hora es delito.”',
    testimonial1Cite: '— Cliente anónimo',
    testimonial2Quote: '“El informe se volvió pieza de defensa en la reunión con el jefe.”',
    testimonial2Cite: '— Ingeniero arrepentido',
    testimonial3Quote: '“El modo terremoto salvó mi sprint. Honorarios pagados con gusto.”',
    testimonial3Cite: '— Product Manager',
    supportEyebrow: 'Proyecto open-source',
    supportTitle: 'Sigue el código y apoya a Saul.',
    supportBody:
      'El repositorio está abierto para auditar, contribuir y sugerir mejoras. Si te gusta, considera patrocinar para mantener las alertas afiladas.',
    supportRepo: 'Ver repositorio en GitHub',
    lightboxClose: 'Cerrar',
    finalCtaTitle: '¿Listo para defender tu foco?',
    finalCtaBody:
      'Instala la extensión, lista tus villanos y deja que Saul negocie con tu procrastinación antes de que llegue al tribunal.',
    finalPrimary: 'Instalar ahora',
    finalSecondary: 'Ver demostración',
    faq1Question: '¿Es gratis?',
    faq1Answer: 'Totalmente. Saul solo cobra atención y sentido del humor.',
    faq2Question: '¿Mis datos salen del navegador?',
    faq2Answer: 'Jamás. Todo queda en <code>chrome.storage.local</code>.',
    faq3Question: '¿Necesito IA?',
    faq3Answer: 'Solo si quieres las narrativas en el informe. El resto funciona offline.',
    footerTitle: 'Extensión Saul Goodman',
    footerBody: 'Instala, lista tus villanos y deja que Saul cobre los honorarios del foco.',
    footerLinkArchitecture: 'Arquitectura',
    footerLinkIndicators: 'Indicadores',
    footerLinkGithub: 'GitHub',
    footerPrivacy: 'Datos 100% locales. Ni el juez los ve.'
  }
};

const richTextKeys = new Set(['feature4Item1', 'faq2Answer']);
const supportedLanguages = ['pt', 'en', 'es'];
const defaultLanguage = 'pt';
let currentLanguage = defaultLanguage;
const BLOG_PREVIEW_LIMIT = 3;
const BLOG_CATEGORY_LABELS = {
  pt: {
    'procrastinacao': 'Procrastinação',
    'foco-atencao': 'Foco & Atenção',
    'dev-performance': 'Performance Dev',
    'trabalho-remoto': 'Trabalho Remoto',
  },
  en: {
    'procrastinacao': 'Procrastination',
    'foco-atencao': 'Focus & Attention',
    'dev-performance': 'Dev Performance',
    'trabalho-remoto': 'Remote Work',
  },
  es: {
    'procrastinacao': 'Procrastinación',
    'foco-atencao': 'Enfoque y Atención',
    'dev-performance': 'Rendimiento Dev',
    'trabalho-remoto': 'Trabajo Remoto',
  },
};
const BLOG_CATEGORY_TONES = {
  'procrastinacao': 'incredulo',
  'foco-atencao': 'like',
  'dev-performance': 'like',
  'trabalho-remoto': 'nao-corte',
};
const BLOG_TONE_ARTWORK = {
  'incredulo': 'assets/saul_incredulo.png',
  'like': 'assets/saul_like.png',
  'nao-corte': 'assets/saul_nao_corte.png',
  'default': 'assets/logotipo_saul_goodman.png',
};
const DATE_LOCALE = {
  pt: 'pt-BR',
  en: 'en-US',
  es: 'es-ES',
};
let blogPreviewPosts = null;
let blogPreviewPromise = null;

const getDictionary = () => translations[currentLanguage] || translations[defaultLanguage];
const t = (key) => {
  const dictionary = getDictionary();
  return dictionary[key] || key;
};

const parseDateValue = (value) => {
  if (!value || typeof value !== 'string') return null;
  const trimmed = value.trim();
  if (!trimmed) return null;
  const dateOnlyMatch = trimmed.match(/^(\d{4})-(\d{2})-(\d{2})$/);
  if (dateOnlyMatch) {
    const year = Number(dateOnlyMatch[1]);
    const month = Number(dateOnlyMatch[2]) - 1;
    const day = Number(dateOnlyMatch[3]);
    const date = new Date(year, month, day);
    return Number.isNaN(date.getTime()) ? null : date;
  }
  const date = new Date(trimmed);
  return Number.isNaN(date.getTime()) ? null : date;
};

const formatBlogDate = (value) => {
  const date = parseDateValue(value);
  if (!date) return value;
  const locale = DATE_LOCALE[currentLanguage] || DATE_LOCALE[defaultLanguage];
  return date.toLocaleDateString(locale, { day: '2-digit', month: 'short', year: 'numeric' });
};

const getLocalizedValue = (data, key) => {
  if (!data) return '';
  if (currentLanguage !== 'pt') {
    const localizedKey = `${key}_${currentLanguage}`;
    if (data[localizedKey]) return data[localizedKey];
  }
  return data[key] || '';
};

const getBlogCategoryLabel = (category) => {
  if (!category) return '';
  const labels = BLOG_CATEGORY_LABELS[currentLanguage] || BLOG_CATEGORY_LABELS[defaultLanguage];
  return labels[category] || category;
};

const getBlogArtwork = (post) => {
  const tone = post?.tone || BLOG_CATEGORY_TONES[post?.category] || 'default';
  return BLOG_TONE_ARTWORK[tone] || BLOG_TONE_ARTWORK.default;
};

const buildBlogPostLink = (post) => {
  const path = (post?.markdown || post?.path || '').replace(/^\//, '');
  const blogBase = new URL('blog/', document.baseURI);
  if (path) {
    const normalized = path.replace(/\.md$/, '');
    return new URL(`posts/${normalized}/`, blogBase).toString();
  }
  if (post?.url) {
    return new URL(post.url, blogBase).toString();
  }
  return new URL('index.html', blogBase).toString();
};

const loadBlogPreviewPosts = async () => {
  if (blogPreviewPosts) return blogPreviewPosts;
  if (blogPreviewPromise) return blogPreviewPromise;
  const url = new URL('blog/index.json', document.baseURI).toString();
  blogPreviewPromise = fetch(url, { headers: { Accept: 'application/json' } })
    .then((response) => {
      if (!response.ok) throw new Error(`Falha ao carregar blog (${response.status})`);
      return response.json();
    })
    .then((data) => {
      blogPreviewPosts = Array.isArray(data?.posts) ? data.posts : [];
      return blogPreviewPosts;
    })
    .catch((error) => {
      console.error('Falha ao carregar blog', error);
      throw error;
    })
    .finally(() => {
      blogPreviewPromise = null;
    });
  return blogPreviewPromise;
};

const renderBlogPreview = async () => {
  const container = document.getElementById('blog-preview-list');
  if (!container) return;
  container.innerHTML = '';
  const loadingState = document.createElement('div');
  loadingState.className = 'blog-preview-state';
  loadingState.textContent = t('blogPreviewLoading');
  container.appendChild(loadingState);

  try {
    const posts = await loadBlogPreviewPosts();
    const ordered = [...posts].sort((a, b) => {
      const left = parseDateValue(b.date);
      const right = parseDateValue(a.date);
      const leftTime = left ? left.getTime() : 0;
      const rightTime = right ? right.getTime() : 0;
      return leftTime - rightTime;
    });
    const trimmed = ordered.slice(0, BLOG_PREVIEW_LIMIT);
    container.innerHTML = '';
    if (!trimmed.length) {
      const emptyState = document.createElement('div');
      emptyState.className = 'blog-preview-state';
      emptyState.textContent = t('blogPreviewEmpty');
      container.appendChild(emptyState);
      return;
    }

    trimmed.forEach((post) => {
      const card = document.createElement('article');
      card.className = 'blog-preview-card';

      const image = document.createElement('img');
      image.src = getBlogArtwork(post);
      image.alt = t('blogPreviewImageAlt');
      card.appendChild(image);

      const meta = document.createElement('div');
      meta.className = 'blog-preview-meta';
      meta.textContent = `${formatBlogDate(post.date)} · ${getBlogCategoryLabel(post.category)}`;
      card.appendChild(meta);

      const title = document.createElement('h3');
      title.textContent = getLocalizedValue(post, 'title') || post.title || '';
      card.appendChild(title);

      const excerpt = getLocalizedValue(post, 'excerpt') || post.excerpt || '';
      if (excerpt) {
        const excerptEl = document.createElement('p');
        excerptEl.textContent = excerpt;
        card.appendChild(excerptEl);
      }

      const link = document.createElement('a');
      link.className = 'blog-preview-link';
      link.href = buildBlogPostLink(post);
      link.textContent = t('blogPreviewRead');
      card.appendChild(link);

      container.appendChild(card);
    });
  } catch (error) {
    container.innerHTML = '';
    const errorState = document.createElement('div');
    errorState.className = 'blog-preview-state';
    errorState.textContent = t('blogPreviewError');
    container.appendChild(errorState);
  }
};

const createLightbox = () => {
  const backdrop = document.createElement('div');
  backdrop.className = 'lightbox-backdrop';

  const content = document.createElement('div');
  content.className = 'lightbox-content';

  const closeBtn = document.createElement('button');
  closeBtn.className = 'lightbox-close';
  closeBtn.type = 'button';
  closeBtn.dataset.i18n = 'lightboxClose';
  closeBtn.textContent = 'Fechar';

  const img = document.createElement('img');
  img.alt = '';

  const caption = document.createElement('div');
  caption.className = 'lightbox-caption';

  content.appendChild(closeBtn);
  content.appendChild(img);
  content.appendChild(caption);
  backdrop.appendChild(content);

  document.body.appendChild(backdrop);
  return backdrop;
};

let lightbox;
let introAudio;
let introAudioPlayed = false;
const introAudioSrc = 'assets/audio/voicy-better-call-saul.aac';
const quakeAudioSrc = 'assets/audio/terremoto-siren.aac';
let quakeAudio;
let quakeTimeout;
let quakeOverlay;

const setupLightbox = () => {
  lightbox = createLightbox();
  const imgEl = lightbox.querySelector('img');
  const captionEl = lightbox.querySelector('.lightbox-caption');
  const closeBtn = lightbox.querySelector('.lightbox-close');

  const close = () => lightbox.classList.remove('active');

  closeBtn.addEventListener('click', close);
  lightbox.addEventListener('click', (event) => {
    if (event.target === lightbox) {
      close();
    }
  });
  window.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') close();
  });

  document.querySelectorAll('.demo-actions a[data-preview]').forEach((link) => {
    link.addEventListener('click', (event) => {
      if (event.metaKey || event.ctrlKey) return; // allow open in new tab
      event.preventDefault();
      const src = link.getAttribute('data-preview');
      const caption = link.closest('.demo-figure')?.querySelector('figcaption')?.textContent || '';
      if (src) {
        imgEl.src = src;
        captionEl.textContent = caption;
        lightbox.classList.add('active');
      }
    });
  });
};

const rotateCarousel = (carousel, delta) => {
  const slides = Array.from(carousel.querySelectorAll('.demo-figure'));
  if (!slides.length) return;
  let currentIndex = slides.findIndex((el) => el.classList.contains('active'));
  if (currentIndex < 0) currentIndex = 0;
  const nextIndex = (currentIndex + delta + slides.length) % slides.length;
  slides.forEach((slide, idx) => slide.classList.toggle('active', idx === nextIndex));
  updateCarouselPreview(carousel);
};

const setupCarousels = () => {
  document.querySelectorAll('[data-carousel]').forEach((carousel) => {
    const slides = Array.from(carousel.querySelectorAll('.demo-figure'));
    if (!slides.length) return;
    if (!slides.some((slide) => slide.classList.contains('active'))) {
      slides[0].classList.add('active');
    }
    updateCarouselPreview(carousel);
  });

  document.addEventListener('click', (event) => {
    const btn = event.target.closest('.carousel-btn');
    if (!btn) return;
    const carousel = btn.closest('[data-carousel]');
    if (!carousel) return;
    event.preventDefault();
    const delta = btn.getAttribute('data-action') === 'next' ? 1 : -1;
    rotateCarousel(carousel, delta);
  });
};

const normalizeLanguage = (value) => {
  if (!value || typeof value !== 'string') return defaultLanguage;
  const normalized = value.toLowerCase();
  if (normalized.startsWith('pt')) return 'pt';
  if (normalized.startsWith('es')) return 'es';
  if (normalized.startsWith('en')) return 'en';
  return defaultLanguage;
};

const setMetaContent = (selector, value) => {
  if (!value) return;
  const element = document.querySelector(selector);
  if (!element) return;
  element.setAttribute('content', value);
};

const updateSiteSeo = (dictionary) => {
  if (!dictionary) return;
  if (dictionary.seoTitle) {
    document.title = dictionary.seoTitle;
    setMetaContent('meta[property="og:title"]', dictionary.seoTitle);
    setMetaContent('meta[name="twitter:title"]', dictionary.seoTitle);
  }
  if (dictionary.seoDescription) {
    setMetaContent('meta[name="description"]', dictionary.seoDescription);
    setMetaContent('meta[property="og:description"]', dictionary.seoDescription);
    setMetaContent('meta[name="twitter:description"]', dictionary.seoDescription);
  }
};

const applyTranslations = (language) => {
  const lang = supportedLanguages.includes(language) ? language : defaultLanguage;
  currentLanguage = lang;
  const dictionary = translations[lang] || translations[defaultLanguage];
  updateSiteSeo(dictionary);
  document.documentElement.lang = lang === 'pt' ? 'pt-BR' : lang;
  document.querySelectorAll('[data-i18n]').forEach((element) => {
    const key = element.getAttribute('data-i18n');
    const text = dictionary[key];
    if (!text) return;
    if (richTextKeys.has(key)) {
      element.innerHTML = text;
    } else {
      element.textContent = text;
    }
  });
  document.querySelectorAll('[data-i18n-alt]').forEach((element) => {
    const key = element.getAttribute('data-i18n-alt');
    const text = dictionary[key];
    if (!text) return;
    element.setAttribute('alt', text);
  });
  const selector = document.getElementById('language-select');
  if (selector && selector.value !== lang) {
    selector.value = lang;
  }
  if (selector) {
    selector.setAttribute('aria-label', dictionary.languageLabel);
  }
  const lightboxClose = document.querySelector('.lightbox-close');
  if (lightboxClose && dictionary.lightboxClose) {
    lightboxClose.textContent = dictionary.lightboxClose;
  }
};

const detectLanguage = () => {
  const stored = localStorage.getItem('saul-language');
  if (stored) return normalizeLanguage(stored);
  const fromNavigator = normalizeLanguage(
    (navigator.languages && navigator.languages[0]) || navigator.language || ''
  );
  return supportedLanguages.includes(fromNavigator) ? fromNavigator : defaultLanguage;
};

const bindLanguageSelector = () => {
  const selector = document.getElementById('language-select');
  if (!selector) return;
  selector.addEventListener('change', (event) => {
    const value = normalizeLanguage(event.target.value);
    localStorage.setItem('saul-language', value);
    applyTranslations(value);
    renderBlogPreview();
  });
};

const setupCounters = () => {
  const counters = document.querySelectorAll('[data-counter]');
  const counterObserver = new IntersectionObserver(
    (entries, observer) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) return;
        const el = entry.target;
        const target = Number(el.getAttribute('data-counter')) || 0;
        let current = 0;
        const step = Math.max(1, Math.floor(target / 40));
        const interval = setInterval(() => {
          current += step;
          if (current >= target) {
            el.textContent = target.toString();
            clearInterval(interval);
          } else {
            el.textContent = current.toString();
          }
        }, 40);
        observer.unobserve(el);
      });
    },
    { threshold: 0.4 }
  );
  counters.forEach((counter) => counterObserver.observe(counter));
};

const setupIntroAudio = () => {
  if (!introAudio) {
    introAudio = new Audio(introAudioSrc);
    introAudio.preload = 'auto';
    introAudio.volume = 0.85;
  }

  const tryPlay = () => {
    if (introAudioPlayed || !introAudio) return Promise.resolve();
    const playPromise = introAudio.play();
    if (playPromise && typeof playPromise.then === 'function') {
      return playPromise
        .then(() => {
          introAudioPlayed = true;
        })
        .catch(() => Promise.reject());
    }
    introAudioPlayed = true;
    return Promise.resolve();
  };

  const armOnFirstInteraction = () => {
    const handler = () => {
      tryPlay().finally(() => {
        document.removeEventListener('pointerdown', handler);
        document.removeEventListener('keydown', handler);
        document.removeEventListener('touchstart', handler);
      });
    };
    document.addEventListener('pointerdown', handler, { once: true });
    document.addEventListener('keydown', handler, { once: true });
    document.addEventListener('touchstart', handler, { once: true });
  };

  tryPlay().catch(() => {
    armOnFirstInteraction();
  });
};

const ensureQuakeAudio = () => {
  if (!quakeAudio) {
    quakeAudio = new Audio(quakeAudioSrc);
    quakeAudio.preload = 'auto';
    quakeAudio.volume = 0.9;
  }
  return quakeAudio;
};

const createQuakeOverlay = () => {
  const overlay = document.createElement('div');
  overlay.className = 'quake-overlay';
  overlay.innerHTML = `
    <div class="quake-card">
      <p class="quake-title" data-i18n="quakeOverlayTitle">Modo terremoto acionado!</p>
      <p class="quake-copy" data-i18n="quakeOverlayBody">Saul está derrubando as abas vilãs. Volte ao foco antes que ele cobre honorários.</p>
      <button type="button" class="quake-close" data-i18n="quakeOverlayClose">Voltar ao foco</button>
    </div>
  `;
  document.body.appendChild(overlay);
  return overlay;
};

const stopQuakeDemo = () => {
  document.body.classList.remove('quake-active');
  if (quakeOverlay) {
    quakeOverlay.classList.remove('active');
  }
  if (quakeAudio) {
    quakeAudio.pause();
    quakeAudio.currentTime = 0;
  }
  if (quakeTimeout) {
    clearTimeout(quakeTimeout);
    quakeTimeout = null;
  }
};

const startQuakeDemo = () => {
  if (!quakeOverlay) {
    quakeOverlay = createQuakeOverlay();
  }
  quakeOverlay.classList.add('active');
  document.body.classList.add('quake-active');

  const closeBtn = quakeOverlay.querySelector('.quake-close');
  const overlayClick = (event) => {
    if (event.target === quakeOverlay) {
      stopQuakeDemo();
    }
  };
  quakeOverlay.addEventListener('click', overlayClick, { once: true });
  closeBtn?.addEventListener('click', stopQuakeDemo, { once: true });

  const audio = ensureQuakeAudio();
  if (audio) {
    audio.currentTime = 0;
    audio.play().catch(() => {});
  }
  if (quakeTimeout) clearTimeout(quakeTimeout);
  quakeTimeout = setTimeout(stopQuakeDemo, 5000);
};

const setupParallax = () => {
  window.addEventListener('scroll', () => {
    const hero = document.querySelector('.hero');
    if (!hero) return;
    const offset = window.scrollY;
    hero.style.backgroundPosition = `center ${offset * 0.25}px`;
  });
};

window.addEventListener('DOMContentLoaded', () => {
  setupLightbox();
  applyTranslations(detectLanguage());
  bindLanguageSelector();
  renderBlogPreview();
  setupCarousels();
  setupCounters();
  setupParallax();
  setupIntroAudio();
  document.addEventListener('click', (event) => {
    const trigger = event.target.closest('[data-quake-trigger]');
    if (trigger) {
      event.preventDefault();
      startQuakeDemo();
    }
  });
});
const updateCarouselPreview = (carousel) => {
  const slides = Array.from(carousel.querySelectorAll('.demo-figure'));
  if (!slides.length) return;
  const previewLink = carousel.querySelector('.demo-preview');
  const currentIndex = slides.findIndex((el) => el.classList.contains('active'));
  const activeSlide = slides[currentIndex >= 0 ? currentIndex : 0];
  const src = activeSlide?.getAttribute('data-src') || activeSlide?.querySelector('img')?.getAttribute('src');
  if (src && previewLink) {
    previewLink.dataset.preview = src;
    previewLink.href = src;
  }
};
